<main class="container">
    <section class="item-header">
      <h1><%=@item.name%></h1>
      <div class="meta">
        <span>⭐ <%=@item.rating%></span>
        <a href="#">item.review</a>
        <%# <span>🥇 Supervendeur · <a href="#">Bordeaux, France</a></span> %>
      </div>
    </section>




    <%# <div class="gallery row">
      <div class="col-6">
      <%= cl_image_tag @item.image.key, class: "main-image object-fit-cover w-100" %>
      <%# </div> %>
      <%# <div class="main-image"><img src="nimbus-main.jpg" alt="nimbus" /></div> %>
      <%# <div class="thumbnails col-5"> %>
        <%# <%= cl_image_tag @item.image.key %>
        <%# <%= cl_image_tag @item.image.key %>
        <%# <%= cl_image_tag @item.image.key %>
        <%# <%= cl_image_tag @item.image.key %>
      <%# </div> %>
    <%# </div> %>



<h2>Reviews</h2>

<% if @item.reviews.any? %>
  <ul>
    <% @item.reviews.each do |review| %>
      <li>
        <strong><%= review.user.name %>:</strong>
        <%= review.content %> 
        <small><%= time_ago_in_words(review.created_at) %> ago</small>
        <%= link_to "Delete review", review_path(review),
              data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this review?" },
              class: "btn btn-sm btn-danger" %>
      </li>
      </li>
    <% end %>
  </ul>
<% else %>
  <p>No reviews yet.</p>
<% end %>


<div data-controller="toggle-form" style="max-width: 250px;">
  <% existing_rating = @item.ratings.find_by(user: current_user) %>

  <% if existing_rating %>
    <p>note : <strong><%= existing_rating.score %></strong> / 10</p>
    <button class="btn btn-outline-secondary btn-sm" data-action="toggle-form#toggle">Modifier ma note</button>
  <% else %>
    <button class="btn btn-primary btn-sm" data-action="toggle-form#toggle">Donner une note</button>
  <% end %>

  <div data-toggle-form-target="form" class="mt-2 hidden">
    <%= simple_form_for([@item, Rating.new]) do |f| %>
      <%= f.input :score, as: :float,
                  label: "Votre note (0 à 10)",
                  input_html: { min: 0, max: 10, step: 0.5, class: "form-control" } %>
      <%= f.submit existing_rating ? "Modifier" : "Noter", class: "btn btn-success btn-sm mt-2" %>
    <% end %>
  </div>
</div>



    <div class="gallery">
      <div class="">
      <%= cl_image_tag @item.image.key, class: "main-image object-fit-cover w-100" %>
      </div>
      <%# <div class="main-image"><img src="nimbus-main.jpg" alt="nimbus" /></div> %>
      <div class="thumbnails col-5">
        <%= cl_image_tag @item.image.key, class: ""  %>
        <%= cl_image_tag @item.image.key, class: "" %>
        <%= cl_image_tag @item.image.key, class: "" %>
        <%= cl_image_tag @item.image.key, class: "" %>
      </div>
    </div>
    </main>

<div class="container2">
    <section class="item-info">
      <h2><%=@item.description%></h2>
      <p>1 place · Poils de chameaux · bois de chêne · 0–75 KM</p>

      <div class="info-box">ℹ️ Moins cher qu’un gros SUV diesel</div>
      <div class="info-box">✨ Peut aussi servir à enlever la poussière</div>

      <div class="description">
        <h3>Description</h3>
        <p>Voir plus</p>
      </div>
    </section>

    <aside class="booking">
      <div class="price">75€ / jour</div>
      <span>⭐ 3.7 · <a href="#">7 commentaires</a></span>

      <form>
        <label>À partir du</label>
        <input type="date" />
        <label>Jusqu'au</label>
        <input type="date" />
        <button>Réserver</button>
      </form>

      <div class="summary">
        <p>79€ × 7 jours — 555€</p>
        <p>Promotion — -28€</p>
        <p><strong>Total : 701€</strong></p>
        <small>Vous ne serez pas débité maintenant</small>
      </div>
    </aside>
    <%= link_to "Edit item",edit_item_path(@item), class: "btn btn-secondary"%>

<%= link_to "Edit item",edit_item_path(@item), class: "btn btn-secondary"%>
<%= link_to "Add a review", new_item_review_path(@item), class: "btn btn-secondary" %>



  </div>


<%# <% if @item.image.attached? %>
  <%# <%= cl_image_tag @item.image.key, height: 300, width: 400, crop: :fill %>
<%# <% end %>

